<html class="no-js" lang="">
		<head>
				<meta charset="utf-8">
				<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
				<title>COMP3207</title>
				<meta name="description" content="">
				<meta name="viewport" content="width=device-width, initial-scale=1">

				<link rel="stylesheet" href="css/bootstrap.min.css">
				<link rel="stylesheet" href="css/bootstrap-theme.min.css">
				<link rel="stylesheet" href="css/main.css">

				<script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
				<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
				<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>

				<!-- Full Calendar imports -->
				<link rel='stylesheet' href='js/fullcalendar/fullcalendar.css' />
				<script src='js/moment.js'></script>
				<script src='js/fullcalendar/fullcalendar.js'></script>
				<script src='js/qtip/jquery.qtip.min.js'></script>
				<link rel='stylesheet' href='js/qtip/jquery.qtip.min.css' />

				<script src="https://apis.google.com/js/platform.js" async defer></script>
				<meta name="google-signin-client_id" content="110052355668-ill69eihnsdnai3piq6445qvc0e19et6.apps.googleusercontent.com">
				<script src="js/vendor/bootstrap.min.js"></script>

				<script src="js/main.js"></script>
				<script>
					function signOut() {
						var auth2 = gapi.auth2.getAuthInstance();
						auth2.signOut().then(function () {
							console.log('User signed out.');
						});
					}
				</script>

				<!-- DatePicker -->
				<link rel='stylesheet' href='js/datepicker/css/bootstrap-datepicker.css' />
				<link rel='stylesheet' href='js/datepicker/css/bootstrap-datepicker.min.css' />
				<script src='js/datepicker/js/bootstrap-datepicker.js'></script>
				<script src='js/datepicker/js/bootstrap-datepicker.min.js'></script>
				<script src='js/datepicker/locales/bootstrap-datepicker.uk.min.js'></script>

				<!-- TimePicker -->
				<script src='js/timepicker/js/bootstrap-timepicker.js'></script>
				<link rel='stylesheet' href='js/timepicker/css/bootstrap-timepicker.min.css' />

				<!--Colour picker-->
				<script src='js/spectrum/spectrum.js'></script>
				<link rel='stylesheet' href='js/spectrum/spectrum.css' />
				<!-- Drop Down Picker -->
				<script>
					$( document.body ).on( 'click', '.dropdown-menu li', function( event ) {

						 var $target = $( event.currentTarget );

						 $target.closest( '.btn-group' )
								.find( '[data-bind="label"]' ).text( $target.text() )
									 .end()
								.children( '.dropdown-toggle' ).dropdown( 'toggle' );

						 return false;

					});
					$('.datepicker').datepicker();
					//$('#timepicker6').timepicker({showInputs: false, minuteStep: 5, showMeridian: false, defaultTime:false, pick12HourFormat: false, format: 'HH:mm' });
					//$('#timepicker7').timepicker({showInputs: false, minuteStep: 5, showMeridian: false, defaultTime:false, pick12HourFormat: false, format: 'HH:mm' });
					//$('#timepicker8').timepicker({showInputs: false, minuteStep: 5, showMeridian: false, defaultTime:false, pick12HourFormat: false, format: 'HH:mm' });

					
					$( document ).ready(function() {
						$(".colorpicker").spectrum({
						    color: "gray",
						    showInput: true,
						    className: "full-spectrum",
						    showInitial: true,
						    showPalette: true,
						    showSelectionPalette: true,
						    maxSelectionSize: 10,
						    preferredFormat: "hex",
						    localStorageKey: "spectrum.demo",
						    move: function (color) {
						        
						    },
						    show: function () {
						    
						    },
						    beforeShow: function () {
						    
						    },
						    hide: function () {
						    
						    },
						    change: function() {
						        
						    },
						    palette: [
						        ["rgb(0, 0, 0)", "rgb(67, 67, 67)", "rgb(102, 102, 102)",
						        "rgb(204, 204, 204)", "rgb(217, 217, 217)","rgb(255, 255, 255)"],
						        ["rgb(152, 0, 0)", "rgb(255, 0, 0)", "rgb(255, 153, 0)", "rgb(255, 255, 0)", "rgb(0, 255, 0)",
						        "rgb(0, 255, 255)", "rgb(74, 134, 232)", "rgb(0, 0, 255)", "rgb(153, 0, 255)", "rgb(255, 0, 255)"], 
						        ["rgb(230, 184, 175)", "rgb(244, 204, 204)", "rgb(252, 229, 205)", "rgb(255, 242, 204)", "rgb(217, 234, 211)", 
						        "rgb(208, 224, 227)", "rgb(201, 218, 248)", "rgb(207, 226, 243)", "rgb(217, 210, 233)", "rgb(234, 209, 220)", 
						        "rgb(221, 126, 107)", "rgb(234, 153, 153)", "rgb(249, 203, 156)", "rgb(255, 229, 153)", "rgb(182, 215, 168)", 
						        "rgb(162, 196, 201)", "rgb(164, 194, 244)", "rgb(159, 197, 232)", "rgb(180, 167, 214)", "rgb(213, 166, 189)", 
						        "rgb(204, 65, 37)", "rgb(224, 102, 102)", "rgb(246, 178, 107)", "rgb(255, 217, 102)", "rgb(147, 196, 125)", 
						        "rgb(118, 165, 175)", "rgb(109, 158, 235)", "rgb(111, 168, 220)", "rgb(142, 124, 195)", "rgb(194, 123, 160)",
						        "rgb(166, 28, 0)", "rgb(204, 0, 0)", "rgb(230, 145, 56)", "rgb(241, 194, 50)", "rgb(106, 168, 79)",
						        "rgb(69, 129, 142)", "rgb(60, 120, 216)", "rgb(61, 133, 198)", "rgb(103, 78, 167)", "rgb(166, 77, 121)",
						        "rgb(91, 15, 0)", "rgb(102, 0, 0)", "rgb(120, 63, 4)", "rgb(127, 96, 0)", "rgb(39, 78, 19)", 
						        "rgb(12, 52, 61)", "rgb(28, 69, 135)", "rgb(7, 55, 99)", "rgb(32, 18, 77)", "rgb(76, 17, 48)"]
						    ]
						});
						function buildHtmlTable(selector) {
							$.getJSON( "/taskfeed", function( data ) {
							  var items = [];
							  var month = '';
							  $.each( data, function( key, val ) {
							  	if( val['month'] !== month ) {
							  		month = val['month'];
							  		items.push( "<div class='table-heading'>" + month + "</div>" );
							    }
							    
								items.push( "<li class='list-group-item' id='"+ val['id'] +"' data-style='button' data-color='"+ val['color'] +"'style='color:"+ val['color'] + "'>" + val['datetime'] + " " + val['title']  + "</li>" );
							  });
								if(items.length == 0){
									items.push( "<p>You have no tasks to do!</p>" );
								}
							  $( "<ul/>", {
							    "class": "list-group checked-list-box",
							    "id": "check-list-box",
							    html: items.join( "" )
							  }).appendTo(selector);

							  $(function () {
							    $('.list-group.checked-list-box .list-group-item').each(function () {
							        
							        // Settings
							        var $widget = $(this),
							            $checkbox = $('<input type="checkbox" class="hidden" />'),
							            color = ($widget.data('color') ? $widget.data('color') : "primary"),
							            style = ($widget.data('style') == "button" ? "btn-" : "list-group-item-"),
							            settings = {
							                on: {
							                    icon: 'glyphicon glyphicon-check'
							                },
							                off: {
							                    icon: 'glyphicon glyphicon-unchecked'
							                }
							            };
							            
							        $widget.css('cursor', 'pointer')
							        $widget.append($checkbox);

							        // Event Handlers
							        $widget.on('click', function () {
							            $checkbox.prop('checked', !$checkbox.is(':checked'));
							            updateDisplay();
							        });
							       
						          

							        // Actions
							        function updateDisplay() {
							            var isChecked = $checkbox.is(':checked');

							            // Set the button's state
							            $widget.data('state', (isChecked) ? "on" : "off");

							            // Set the button's icon
							            $widget.find('.state-icon')
							                .removeClass()
							                .addClass('state-icon ' + settings[$widget.data('state')].icon);

							            // Update the button's color
							            if (isChecked) {
							                
							                $widget.css({"background-color":color,"color":'black'});

											console.log($widget);
											console.log($checkbox);
											
	                						$('#modal-footer').empty().append('<button type="button" class="btn btn-default" data-dismiss="modal" onclick="cancelDeleteTask('+$widget.attr('id')+')">Cancel</button><a class="btn btn-danger btn-ok" id="taskdelete" onclick="deleteTask('+$widget.attr('id')+')">Delete</a>');
							                $('#confirm-delete').modal('toggle');
							                
							            } 
							            else {
							                
							                $widget.css({"background-color":"white","color":color});
							            }
							        }

							        // Initialization
							        function init() {
							            
							            if ($widget.data('checked') == true) {
							                $checkbox.prop('checked', !$checkbox.is(':checked'));
							            }
																				
							            updateDisplay();

							            // Inject the icon if applicable
							            if ($widget.find('.state-icon').length == 0) {
							                $widget.prepend('<span class="state-icon ' + settings[$widget.data('state')].icon + '"></span>');
							            }
							        }
							        init();
						    	});
						    
							    $('#get-checked-data').on('click', function(event) {
							        event.preventDefault(); 
							        var checkedItems = {}, counter = 0;
							        $("#check-list-box li.active").each(function(idx, li) {
							            checkedItems[counter] = $(li).text();
							            counter++;
							        });
							        $('#display-json').html(JSON.stringify(checkedItems, null, '\t'));
							    });
							  });

							});
							
							
						}
						function buildDeadlinesBox(selector) {
							$.getJSON( "/taskboxfeed", function( data ) {
							  var items = [];
							  var month = '';
							  $.each( data, function( key, val ) {
							    items.push( "<li>" + val['datetime'] + " " + val['title']  + "</li>" );
							  });
							 
							  $( "<ul/>", {
							    "class": "",
							    "id": "",
							    html: items.join( "" )
							  }).appendTo(selector);

							  
							});
						}

						buildHtmlTable('#excelDataTable');
						buildDeadlinesBox('#deadlinesbox');
						$('#confirm-delete').modal({ backdrop: 'static', keyboard: false });

					
					});
					function deleteTask(id) {
			            var xhr = new XMLHttpRequest();
						xhr.open('POST', 'http://testproj-1113.appspot.com/removetask');
						xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
						xhr.onload = function() {
							window.location.replace('/calendar');
						};
						xhr.send('taskid=' + id);
			        }
					function cancelDeleteTask(id) {
						var li = document.getElementById(id);
						var checkbox = li.getElementsByTagName("input")[0];

						console.log(checkbox.checked);
						checkbox.checked = false;
						console.log(checkbox.checked);
		
		
					
						/*current = $("#" + id + " input").val();
						console.log(current);
						$("#" + id + " input").attr('checked', !current);
						console.log($("#" + id + " input").val());*/
			        }					
					
			       
				</script>
				<style>
					.bootstrap-timepicker-widget.dropdown-menu.open{
						z-index: 1500;
					}
					body {
						padding-top: 50px;
						padding-bottom: 20px;
					}
					.form-horizontal .form-group {
						margin-left:0;
						margin-right: 0;
					}
					.form-group{
						margin-bottom: 0;
					}
					.row{
						padding-bottom: 15px;
					}
					.full-spectrum .sp-palette {
						max-width: 200px;
					}
					.table-heading{
						padding-top: 10px;
						padding-bottom: 10px;
						font-weight: bold;
					}
					.state-icon {
					    left: -5px;
					}
					.list-group-item-primary {
					    color: rgb(255, 255, 255);
					    background-color: rgb(66, 139, 202);
					}
					.list-group-item-deleted {
					      position: relative;
						  display: block;
						  padding: 10px 15px;
						  margin-bottom: -1px;
						  background-color: #fff;
						  border: 1px solid #ddd;
						  color: #777;
						  cursor: default;
						  background-color: #eee;
					}
				</style>

		</head>


		<body>
		<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#">COMP3207</a>
				</div>
				<div id="navbar" class="navbar-collapse collapse">
				</div><!--/.navbar-collapse -->
			</div>
		</nav>
	
	<br><br>

		<div class="container">

				<div class="row">
						<div class="col-xs-9">
						    <ul class="nav nav-pills nav-justified">
						        <li class="nav active"><a href="#events" data-toggle="tab">Calendar</a></li>
						        <li class="nav"><a href="#tasks" data-toggle="tab">Tasks</a></li>
						        <li class="nav"><a href="#groups" data-toggle="tab">Groups</a></li>
						    </ul>
							
							<br/>
							<!-- Tab panes -->
						    <div class="tab-content">
						        <div class="tab-pane fade in active" id="events"><div id="calendar"></div></div>
						        <div class="tab-pane fade" id="tasks"><div class="well" style="" id="excelDataTable"></div></div>
						        <div class="tab-pane fade" id="groups">Content inside tab Groups</div>
						    </div>
						</div>
						<div class="col-xs-3">

								<div class="panel panel-default">
									<div class="panel-heading">Add/edit contents</div>
									<div class="panel-body">
										<ul>
											<li><a href="#" data-toggle="modal" data-target="#addModuleModal">Add Events</a></li>
											<!-- Modal -->
											<div id="addModuleModal" class="modal fade" role="dialog">
												<div class="modal-dialog">
													<!-- Modal content-->
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal">&times;</button>
															<h4 class="modal-title">Add Events</h4>
														</div>
														<div class="modal-body">	
															<!-- Form within Modal -->
															<form class="form-horizontal" role="form" method="post" action="/event">
																<div class="row">
																	<div class="col-xs-12">
																		<label for="eventname">Event Name:</label><br/>
																		<input id="eventname" type="text" name="name" placeholder="Event Name" class="form-control" aria-label="">
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-12">
																		<div class="form-group">
																			<label for="eventtype">Event Type:</label><br/>
																			<select id="eventtype" name="event_type" class="form-control">
																				<option value="module">Module</option>
																				<option value="society">Society</option>
																				<option value="job">Job</option>
																				<option value="other">Other</option>
																			</select>
																		</div>
																	</div>
																</div>
																<div class="row" class="input-group">
																	<div class="col-xs-12">
																		<label for="eventlocation">Event Location:</label><br/>
																		<input name="location" id="eventlocation" type="text" placeholder="Location - Building/Room Number" class="form-control" aria-label="">
																	</div>
																</div>
																<div class="row">
																	<div class="input-group" style-width:"100%">
																		<div class="col-xs-6">
																			<label for="startdate">Start Date:</label><br/>
																			<input id="startdate" name="start_date" type="text" data-provide="datepicker" placeholder="Deadline Date" class="form-control" aria-label="">
																		</div>
																		<div class="col-xs-6">
																			<label for="timepicker6">Start Time:</label><br/>
																			<input name="start_time" id="timepicker6" data-provide="timepicker" class="form-control" type="text" class="input-small" data-provide="timepicker" data-template="dropdown" data-minute-step="5" data-show-meridian="false">
																		</div>
																	</div>
																</div>
																<div class="row">
																	<div class="input-group" style-width:"100%">
																		<div class="col-xs-6">
																			<label for="enddate">End Date:</label><br/>
																			<input name="end_date" id="enddate" type="text" data-provide="datepicker" placeholder="Deadline Date" class="form-control" aria-label="...">
																		</div>
																		<div class="col-xs-6">
																			<label for="timepicker8">End Time:</label><br/>
																			<input name="end_time" id="timepicker8" class="form-control" type="text"  data-provide="timepicker" data-template="dropdown" data-minute-step="5" data-show-meridian="false" class="input-small">
																			<i class="icon-time"></i>
																		</div>	
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-12">
																		<label for="colorcode">Choose a colour code:</label><br/>
																		<input type='text' class="colorpicker" name="color2" value="gray" class="form-control"/>
																	</div>
																</div>
																<br/>
																<div class="modal-footer">
																	<button type="submit" class="btn btn-default">Submit</button>
																</form><!-- //Form within Modal -->
															</div>
														</div>
													</div>
													<!-- //Modal Content -->
												</div>
											</div>
											<!-- //Modal -->

											<li><a href="#" data-toggle="modal" data-target="#addAssignmentModal">Add Task</a></li>
											<!-- Modal -->
											<div id="addAssignmentModal" class="modal fade" role="dialog">
												<div class="modal-dialog">

													<!-- Modal content-->
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal">&times;</button>
															<h4 class="modal-title">Add Task</h4>
														</div>
														<div class="modal-body">
															<!-- Form within Modal -->
															<form class="form-horizontal" role="form" method="post" action="/task">
																<div class="row">
																	<div class="col-xs-12">
																		<label for="sel2">Task Name:</label>
																		<input type="text" name="task_name" id="sel2" class="form-control" aria-label=""/>
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-12">
																		<div class="form-group">
																		  	<label for="sel1">Task Type:</label>
																		  	<select class="form-control" id="sel1" name="task_type">
																		    	<option value="assignment">Assignment</option>
																				<option value="work">Work</option>
																				<option value="other">Other</option>
																		  	</select>
																		</div>
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-1">
																		<label for="datepicker1">Date:</label>
																	</div>
																	<div class="col-xs-3">
																		<input name="deadline_date" type="text" id="datepicker1" data-provide="datepicker" class="form-control" aria-label="">
																	</div>
																	<div class="col-xs-1">
																		<label for="timepicker7">Time:</label>
																	</div>
																	<div class="col-xs-3">
																		<input name="deadline_time" id="timepicker7" class="form-control" type="text"  data-provide="timepicker" data-template="dropdown" data-minute-step="5" data-show-meridian="false">
																	</div>
																	
																</div><!-- /.row -->
																<div class="row">
																	<div class="col-xs-12">
																		<label for="colorcode2">Choose a colour code:</label>
																		<input id="colorcode2" type='text' class="colorpicker" name="color" value="gray" class="form-control"/>
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-12">
																		<button type="submit" class="btn btn-default">Submit</button>
																	</div>
																</div>
															</form>
														</div>
													</div>
													<!-- //Modal Content -->
												</div>
											</div>
											<!-- //Modal -->
											
											
											<li><a href="#" data-toggle="modal" data-target="#addGroupModal">Add Group</a></li>
											<!-- Modal -->
											<div id="addGroupModal" class="modal fade" role="dialog">
												<div class="modal-dialog">
													<!-- Modal content-->
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal">&times;</button>
															<h4 class="modal-title">Group</h4>
														</div>
														<div class="modal-body">
															<!-- Form within Modal -->
															<form class="form-horizontal" role="form" method="post" action="/group">
																<div class="row">
																	<div class="col-xs-12">
																		<label for="sel2">Group Name:</label>
																		<input type="text" name="group_name" id="sel2" class="form-control" aria-label=""/>
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-12">
																		<label for="sel2">Description:</label>
																		<input type="text" name="group_description" id="sel2" class="form-control" aria-label=""/>
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-12">
																		<label for="sel2">Member Email:</label>
																		<div class="row" style="">
																			<div class="col-xs-12">
																				<div class="input-group">
																					<input type="text" name="email1" id="" value="" class="form-control" placeholder="example@email.com">
																					<span class="input-group-btn">
																						<button class="btn btn-default" type="button" onclick="addInput()">Add</button>
																					</span>
																				</div>
																			</div>
																			
																			<div id="responce"></div>
																		</div>
																		<script>
																			var countBox =2;
																			var boxName = 0;
																			function addInput()
																			{
																				 var boxName="textBox"+countBox; 
																			document.getElementById('responce').innerHTML+='<div class="col-xs-12"><input type="text" name="email'+countBox+'" id="'+boxName+'" value="'+boxName+'" " class="form-control"  /></div>';
																				 countBox += 1;
																			}
																		</script>
																	</div>
																</div>
																<div class="row">
																	<div class="col-xs-12">
																		<button type="submit" class="btn btn-default">Submit</button>
																	</div>
																</div>
															</form>
														</div>
													</div>
													<!-- //Modal Content -->
												</div>
											</div>
										</ul>
									</div>
								</div>

								<div class="panel panel-default">
									<div class="panel-heading">Group Hub</div>
									<div class="panel-body">
										<ul>
												<li><a href="#">Group 1</a></li>
												<li><a href="#">Group 2</a></li>
												<li><a href="#">Group 3</a></li>
										</ul>
									</div>
								</div>

								<div class="panel panel-default">
									<div class="panel-heading">Tasks</div>
									<div class="panel-body">
										<div id="deadlinesbox">
										</div>
									</div>
								</div>
						</div>
				</div>
		</div>
		<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" id="confirm-delete2">
            <div class="modal-content">
            
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Confirm Delete</h4>
                </div>
            
                <div class="modal-body">
                    <p>Do you want to delete this task?</p>
                </div>
                
                <div class="modal-footer" id="modal-footer">
                    
                </div>
            </div>
        </div>
    </div>
	</body>
</html>